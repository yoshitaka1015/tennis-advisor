<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>機能要望フォーム | Tennis Advisor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="robots" content="noindex,nofollow">
  <style>
    :root{ --bg:#0B0B0B; --card:#111213; --text:#F4F4F4; --text2:#CFCFCF; --accent:#2C8A3B; --accent2:#7B3FA1; --sep:#2A2C29; --err:#c0392b; }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ margin:0; padding:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif; }
    a{ color:var(--accent2); text-decoration:none; } a:hover{text-decoration:underline;}
    .container{ max-width:720px; margin:0 auto; padding:16px; }
    nav{ margin:8px 0 16px; font-size:14px; }
    header{ padding:16px 0 8px; }
    header h1{ font-size:20px; margin:0 0 4px; }
    header p{ margin:0; color:var(--text2); font-size:14px; }
    .card{ background:var(--card); border:1px solid var(--sep); border-radius:12px; padding:16px; }
    .label{ display:block; font-size:13px; color:var(--text2); margin:12px 0 6px; }
    .optional{ margin-left:6px; font-size:12px; color:var(--text2); opacity:.8; }
    .input{ width:100%; background:#0d0d0e; color:var(--text); border:1px solid var(--sep); border-radius:10px; padding:10px 12px; outline:none; }
    .input:focus{ border-color:var(--accent2); box-shadow:0 0 0 3px rgba(123,63,161,.18); }
    textarea.input{ resize:vertical; min-height:120px; }
    .grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    @media (max-width:640px){ .grid-2{ grid-template-columns:1fr; } }
    .btn-primary{ display:inline-block; border:0; border-radius:999px; background:linear-gradient(90deg, var(--accent), #3aa157); color:#fff; font-weight:600; padding:10px 18px; cursor:pointer; }
    .btn-primary[disabled]{ opacity:.6; cursor:not-allowed; }
    .msg{ display:none; margin:12px 0; padding:12px; border-radius:10px; border:1px solid var(--sep); background:#0f0f10; color:var(--text); }
    .msg.error{ background:rgba(192,57,43,.10); border-color:rgba(192,57,43,.35); color:var(--err); }
    footer{ color:var(--text2); font-size:12px; margin:16px 0 0; }
  </style>
</head>
<body>
  <div class="container">
    <nav><a href="./">← トップへ戻る</a></nav>
    <header>
      <h1>機能要望フォーム</h1>
      <p>いただいたご意見は今後の改善の参考にさせていただきます。<strong>個別返信は原則行っていません</strong>。</p>
    </header>

    <section class="card">
      <div id="msg" class="msg" role="status" aria-live="polite"></div>

      <form id="fs-form" action="https://formspree.io/f/mwpnzrld" method="POST" novalidate>
        <div style="position:absolute;left:-9999px;top:-9999px;">
          <label>Leave empty <input type="text" name="website" autocomplete="off" tabindex="-1"></label>
        </div>

        <label class="label">カテゴリ</label>
        <select name="category" class="input" required>
          <option value="" disabled selected>選択してください</option>
          <option>機能要望</option>
          <option>記録/スコア表示</option>
          <option>スタッツ/分析</option>
          <option>使い勝手/UX</option>
          <option>その他</option>
        </select>

        <div class="grid-2">
          <div>
            <label class="label">端末（例: iPhone 15）<span class="optional">任意</span></label>
            <input type="text" name="device" class="input" placeholder="iPhone 15 / iPad Pro 11&quot;">
          </div>
          <div>
            <label class="label">OSバージョン<span class="optional">任意</span></label>
            <input type="text" name="os" class="input" placeholder="iOS 18.x など">
          </div>
        </div>

        <label class="label">アプリバージョン<span class="optional">任意</span></label>
        <input type="text" name="appVersion" class="input" placeholder="例: 1.0.0">

        <label class="label">内容（できるだけ具体的に）</label>
        <textarea name="message" class="input" required placeholder="例）ポイント入力中に◯◯ができると便利です。"></textarea>

        <label class="label">連絡先（任意 / 返信は原則ありません）</label>
        <input type="email" name="email" class="input" placeholder="返信が必要な場合のみご記入ください">

        <input type="hidden" name="ua" value="">
        <input type="hidden" name="lang" value="">
        <input type="hidden" name="tz" value="">
        <input type="hidden" name="page" value="">
        <input type="hidden" name="app" value="tennis-advisor-web">
        <input type="hidden" name="_subject" value="【Tennis Advisor】機能要望">

        <button id="submit" type="submit" class="btn-primary" style="margin-top:12px;">送信する</button>
      </form>

      <footer>
        送信された内容は <a href="https://formspree.io/" target="_blank" rel="noopener">Formspree</a> を通じて保存・転送されます。詳細は
        <a href="./privacy.html">プライバシーポリシー</a> をご確認ください。
      </footer>
    </section>
  </div>

  <script>
    (function(){
      const form = document.getElementById('fs-form');
      const btn  = document.getElementById('submit');
      const msg  = document.getElementById('msg');

      form.elements['ua'].value   = navigator.userAgent || '';
      form.elements['lang'].value = (navigator.language || (navigator.languages && navigator.languages[0]) || '');
      try { form.elements['tz'].value = Intl.DateTimeFormat().resolvedOptions().timeZone || ''; } catch(e){}
      form.elements['page'].value = location.href;

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const hp = form.querySelector('input[name="website"]');
        if (hp && hp.value) return;

        if (!form.category.value || !form.message.value.trim()){
          show('必須項目を入力してください。', true);
          return;
        }
        btn.disabled = true;

        try{
          const fd = new FormData(form);
          const res = await fetch(form.action, { method:'POST', headers:{'Accept':'application/json'}, body:fd });
          if (res.ok){ form.reset(); show('送信しました。ご協力ありがとうございます。', false); }
          else{ show('送信に失敗しました。時間をおいて再度お試しください。', true); }
        }catch(err){
          show('ネットワークエラーが発生しました。再度お試しください。', true);
        }finally{ btn.disabled = false; }
      });

      function show(text, isError){
        msg.textContent = text;
        msg.className = 'msg' + (isError ? ' error' : '');
        msg.style.display = 'block';
      }
    })();
  </script>
</body>
</html>