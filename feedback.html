---
layout: base
title: 機能要望フォーム | テニスアドバイザー
---

<div class="container">
  <header>
    <h1>機能要望フォーム</h1>
    <p>ご意見は今後の改善の参考にします（返信は原則おこないません）。</p>
  </header>

  <section class="grid">
    <!-- フォーム本体 -->
    <div class="card" id="formCard">
      <h2>ご要望の内容</h2>
      <form id="featureForm"
            action="https://formspree.io/f/mwpnzrld"
            method="POST" novalidate>
        <p class="desc">
          ※ 返信は原則おこないません。ご連絡が必要な場合のみ記入してください（任意）。
        </p>

        <label class="field">
          <span>ご要望・改善してほしい点 <em class="req">必須</em></span>
          <textarea name="message" required rows="6"
                    placeholder="例）ポイント入力のUIで〇〇がしたい、統計で△△を見たい など"></textarea>
        </label>

        <div class="grid-2">
          <label class="field">
            <span>メール（任意・返信が必要な場合のみ）</span>
            <input type="email" name="email" inputmode="email" placeholder="your@example.com">
          </label>
          <label class="field">
            <span>端末 / iOS（任意）</span>
            <input type="text" name="env" placeholder="例）iPhone 15 / iOS 17.5.1">
          </label>
        </div>

        <!-- スパム対策（Honeypot） -->
        <input type="text" name="_gotcha" class="hp" tabindex="-1" autocomplete="off">
        <!-- 件名/言語/フォールバック用リダイレクト -->
        <input type="hidden" name="_subject" value="Tennis Advisor: 機能要望">
        <input type="hidden" name="_language" value="ja">
        <input type="hidden" name="_redirect" value="{{ '/' | relative_url }}thanks.html">

        <div class="actions">
          <button type="submit" class="btn">送信する</button>
        </div>

        <p id="errorBox" class="alert hidden">送信に失敗しました。時間をおいて再度お試しください。</p>
      </form>
    </div>

    <!-- 成功メッセージ（JS成功時に表示） -->
    <div id="successCard" class="card hidden">
      <h2>ありがとうございます！</h2>
      <p>送信が完了しました。いただいた内容は今後の改善に活かします。</p>
      <div class="actions">
        <a class="btn secondary" href="{{ '/' | relative_url }}">トップへ戻る</a>
      </div>
    </div>
  </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('featureForm');
  const formCard = document.getElementById('formCard');
  const success = document.getElementById('successCard');
  const errorBox = document.getElementById('errorBox');

  form.addEventListener('submit', async (e) => {
    e.preventDefault(); // 既定の送信を止めて fetch で送る
    errorBox.classList.add('hidden');

    try {
      const res = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      });

      if (res.ok) {
        formCard.classList.add('hidden');
        success.classList.remove('hidden');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        errorBox.classList.remove('hidden');
      }
    } catch (err) {
      errorBox.classList.remove('hidden');
    }
  });
});
</script>